<!DOCTYPE html>
<html>
<head>
  <title>댓글 표시 예시</title>
</head>
<body>
  <h1>댓글</h1>
  
  <!-- 댓글 입력 폼 -->
  <form id="comment-form">
    <label for="name">이름:</label>
    <input type="text" id="name" name="name" required><br><br>
    
    <label for="comment">댓글:</label><br>
    <textarea id="comment" name="comment" rows="4" cols="50" required></textarea><br><br>
    
    <input type="submit" value="댓글 등록">
  </form>
  
  <!-- 댓글 목록 -->
  <div id="comment-list">
    <!-- 댓글이 여기에 동적으로 추가됩니다 -->
  </div>

  <!-- Firebase JavaScript SDK -->
  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCWoYsufucobVb292hAj3S4HyJYfcYvEV0",
    authDomain: "data-462f4.firebaseapp.com",
    databaseURL: "https://data-462f4-default-rtdb.firebaseio.com",
    projectId: "data-462f4",
    storageBucket: "data-462f4.appspot.com",
    messagingSenderId: "255199382791",
    appId: "1:255199382791:web:93e13f21ae54b93600c9a2",
    measurementId: "G-F7VKLLGK59"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  
    // Firebase Realtime Database 참조
    var database = firebase.database();
    var commentsRef = database.ref("comments");

    // 댓글 폼 제출 시 처리
    document.getElementById("comment-form").addEventListener("submit", function(event) {
      event.preventDefault(); // 폼 제출 기본 동작 막기
      
      // 입력값 가져오기
      var name = document.getElementById("name").value;
      var comment = document.getElementById("comment").value;
      
      if (name && comment) {
        // 댓글 데이터 생성
        var newCommentRef = commentsRef.push();
        var commentData = {
          name: name,
          comment: comment
        };
        // 댓글 데이터 저장
        newCommentRef.set(commentData);
        
        // 입력값 초기화
        document.getElementById("name").value = "";
        document.getElementById("comment").value = "";
      }
    });

    // 댓글 데이터 변경 감지
    commentsRef.on("child_added", function(snapshot) {
      var commentData = snapshot.val();
      var name = commentData.name;
      var comment = commentData.comment;
      
      // 댓글 생성
      var newComment = document.createElement("div");
      newComment.innerHTML = "<h3>" + name + "</h3><p>" + comment + "</p>";
      
      // 댓글 목록에 추가
      document.getElementById("comment-list").appendChild(newComment);
    });
  </script>
</body>
</html>
