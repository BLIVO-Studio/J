<!DOCTYPE html>
<html>
  <head>
    <title>Comment Board</title>
    <!-- Firebase JavaScript SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
  </head>
  <body>
    <h1>Comment Board</h1>
    <div id="comments"></div>
    <form id="comment-form">
      <input type="text" id="comment-input">
      <button type="submit">Submit</button>
    </form>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyAE8RtK24F2cCCQD3Le8B55YfQb57NEhPg",
          authDomain: "comment-data-b6924.firebaseapp.com",
          databaseURL: "https://comment-data-b6924-default-rtdb.firebaseio.com",
          projectId: "comment-data-b6924",
          storageBucket: "comment-data-b6924.appspot.com",
          messagingSenderId: "221488055651",
          appId: "1:221488055651:web:4735f0d5088ce85815ff56",
          measurementId: "G-102DQ8EH0W"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);


      // Firebase Realtime Database 참조
      var database = firebase.database();
      var commentsRef = database.ref("comments");

      // 댓글 등록 이벤트 처리
      var commentForm = document.getElementById("comment-form");
      commentForm.addEventListener("submit", function(event) {
        event.preventDefault();
        var commentInput = document.getElementById("comment-input");
        var commentText = commentInput.value.trim();

        if (commentText !== "") {
          // 댓글 데이터 생성
          var newCommentRef = commentsRef.push();
          var commentData = {
            text: commentText,
            timestamp: firebase.database.ServerValue.TIMESTAMP
          };
          // 댓글 데이터 저장
          newCommentRef.set(commentData);
        }

        commentInput.value = ""; // 입력 필드 초기화
      });

      // 댓글 데이터 변경 감지
      commentsRef.on("child_added", function(snapshot) {
        var commentData = snapshot.val();
        var commentId = snapshot.key;
        var commentText = commentData.text;

        // 댓글 요소 생성
        var commentElement = document.createElement("p");
        commentElement.textContent = commentText;
        commentElement.setAttribute("data-comment-id", commentId);

        // 댓글을 comments 컨테이너에 추가
        var commentsContainer = document.getElementById("comments");
        commentsContainer.appendChild(commentElement);
      });
    </script>
  </body>
</html>
